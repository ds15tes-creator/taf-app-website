<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TAF Airport Lookup</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        .container {
            max-width: 90%;
            margin: 0 auto;
            padding: 2rem;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-lg">
        <h1 class="text-3xl font-bold text-center mb-6 text-gray-800">TAF Airport Lookup</h1>
        
        <div class="mb-4">
            <label for="airportCode" class="block text-sm font-medium text-gray-700 mb-2">Enter ICAO Airport Code (e.g., KLAX):</label>
            <input type="text" id="airportCode" placeholder="Enter ICAO code" 
                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
        </div>
        
        <button id="lookupButton" class="w-full bg-blue-600 text-white font-semibold py-2 rounded-lg hover:bg-blue-700 transition duration-200">
            Get TAF
        </button>

        <div id="loading" class="mt-4 text-center text-gray-500 hidden">
            <div class="flex justify-center items-center">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"></div>
                <span class="ml-2">Loading...</span>
            </div>
        </div>

        <pre id="tafResult" class="mt-6 p-4 bg-gray-50 rounded-lg text-sm text-gray-900 whitespace-pre-wrap overflow-x-auto"></pre>

        <button id="copyButton" class="mt-4 w-full bg-gray-200 text-gray-700 font-semibold py-2 rounded-lg hidden hover:bg-gray-300 transition duration-200">
            Copy to Clipboard
        </button>

        <div id="messageBox" class="mt-4 p-3 rounded-lg text-sm text-center hidden"></div>
    </div>

    <script>
        const airportCodeInput = document.getElementById('airportCode');
        const lookupButton = document.getElementById('lookupButton');
        const tafResult = document.getElementById('tafResult');
        const loadingIndicator = document.getElementById('loading');
        const copyButton = document.getElementById('copyButton');
        const messageBox = document.getElementById('messageBox');
        
        // Show message function
        function showMessage(text, type = 'info') {
            messageBox.textContent = text;
            messageBox.style.display = 'block';
            if (type === 'success') {
                messageBox.className = 'mt-4 p-3 rounded-lg text-sm text-center bg-green-100 text-green-700';
            } else if (type === 'error') {
                messageBox.className = 'mt-4 p-3 rounded-lg text-sm text-center bg-red-100 text-red-700';
            } else {
                messageBox.className = 'mt-4 p-3 rounded-lg text-sm text-center bg-blue-100 text-blue-700';
            }
        }

        // Hide message after a delay
        function hideMessage() {
            setTimeout(() => {
                messageBox.style.display = 'none';
            }, 3000);
        }

        lookupButton.addEventListener('click', async () => {
            const airportCode = airportCodeInput.value.trim().toUpperCase();
            if (airportCode.length !== 4) {
                showMessage('Please enter a valid 4-letter ICAO airport code.', 'error');
                return;
            }

            loadingIndicator.classList.remove('hidden');
            tafResult.textContent = '';
            copyButton.classList.add('hidden');
            messageBox.style.display = 'none';

            try {
                const response = await fetch(`https://api.aviationapi.com/v1/taf?apt=${airportCode}`);
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const data = await response.json();
                
                if (data.status === 'ok' && data.data && data.data.length > 0) {
                    tafResult.textContent = data.data[0].raw_text;
                    copyButton.classList.remove('hidden');
                    showMessage('TAF data retrieved successfully.', 'success');
                } else {
                    tafResult.textContent = 'No TAF data found for this airport. Please check the ICAO code.';
                    showMessage('No TAF data found.', 'info');
                }
            } catch (error) {
                console.error('Error fetching TAF:', error);
                tafResult.textContent = `Error fetching data: ${error.message}`;
                showMessage('An error occurred while fetching data.', 'error');
            } finally {
                loadingIndicator.classList.add('hidden');
                hideMessage();
            }
        });

        copyButton.addEventListener('click', () => {
            if (tafResult.textContent) {
                const tempTextArea = document.createElement('textarea');
                tempTextArea.value = tafResult.textContent;
                document.body.appendChild(tempTextArea);
                tempTextArea.select();
                document.execCommand('copy');
                document.body.removeChild(tempTextArea);
                showMessage('Copied to clipboard!', 'success');
                hideMessage();
            }
        });
    </script>
</body>
</html>
